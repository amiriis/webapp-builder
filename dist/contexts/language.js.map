{"version":3,"file":"language.js","names":["_react","_interopRequireWildcard","require","_router","_useUser","_interopRequireDefault","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","LanguageContext","exports","createContext","LanguageProvider","_ref","children","defaultLocalization","router","useRouter","languageList","key","dir","name","fontFamily","tableLocalization","datatable","chartLocalization","chart","user","userChangedLanguage","changeLanguageState","useUser","languageIsReady","setLanguageIsReady","useState","languageApp","setLanguageApp","process","env","NEXT_PUBLIC_DEFAULT_LANGUAGE","directionApp","setDirectionApp","NEXT_PUBLIC_DEFAULT_DIRECTION","useEffect","lang","localStorage","getItem","setItem","isReady","user_language","locale","replace","pathname","query","asPath","document","timer","setTimeout","clearTimeout","createElement","Provider","value"],"sources":["../../src/lib/contexts/language.js"],"sourcesContent":["import React, {createContext, useEffect, useState} from 'react';\r\nimport {useRouter} from \"next/router\";\r\nimport useUser from \"../hooks/useUser\";\r\n\r\nexport const LanguageContext = createContext();\r\n\r\nexport const LanguageProvider = ({children, defaultLocalization}) => {\r\n    const router = useRouter();\r\n    const languageList = [\r\n        {\r\n            key: \"fa\",\r\n            dir: \"rtl\",\r\n            name: \"فارسی\",\r\n            fontFamily: `IRANSansFaNum, sans-serif`,\r\n            tableLocalization: defaultLocalization['fa'].datatable,\r\n            chartLocalization: defaultLocalization['fa'].chart\r\n        }\r\n    ];\r\n    const {user, userChangedLanguage, changeLanguageState} = useUser();\r\n    const [languageIsReady, setLanguageIsReady] = useState(false);\r\n    const [languageApp, setLanguageApp] = useState(process.env.NEXT_PUBLIC_DEFAULT_LANGUAGE);\r\n    const [directionApp, setDirectionApp] = useState(\r\n        process.env.NEXT_PUBLIC_DEFAULT_DIRECTION\r\n    );\r\n\r\n    useEffect(() => {\r\n        const lang = localStorage.getItem(\"_language\");\r\n\r\n        if (lang) {\r\n            setLanguageApp(lang);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!languageApp) return;\r\n\r\n        const lang = localStorage.getItem(\"_language\");\r\n\r\n        if (!lang) {\r\n            localStorage.setItem(\"_language\", languageApp);\r\n        } else {\r\n            if (languageApp !== lang) {\r\n                localStorage.setItem(\"_language\", languageApp);\r\n            }\r\n        }\r\n    }, [languageApp]);\r\n\r\n    useEffect(() => {\r\n        if (!router.isReady) return;\r\n        if (user.user_language) {\r\n            if (user.user_language !== languageApp) {\r\n                setLanguageApp(user.user_language);\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (languageApp !== router.locale) {\r\n            router.replace(\r\n                {pathname: router.pathname, query: router.query},\r\n                router.asPath,\r\n                {\r\n                    locale: languageApp,\r\n                }\r\n            );\r\n            return;\r\n        }\r\n        for (const lang of languageList) {\r\n            if (languageApp !== lang.key) continue;\r\n            setDirectionApp(lang.dir);\r\n            document.dir = lang.dir;\r\n        }\r\n\r\n        const timer = setTimeout(() => {\r\n            changeLanguageState(false);\r\n            setLanguageIsReady(true);\r\n        }, 1000);\r\n\r\n        return () => {\r\n            clearTimeout(timer);\r\n        };\r\n    }, [router.locale, router.isReady, userChangedLanguage, languageApp]);\r\n\r\n    return (\r\n        <LanguageContext.Provider\r\n            value={{\r\n                languageApp,\r\n                setLanguageApp,\r\n                directionApp,\r\n                languageIsReady,\r\n                setLanguageIsReady,\r\n                languageList,\r\n            }}\r\n        >\r\n            {children}\r\n        </LanguageContext.Provider>\r\n    );\r\n};"],"mappings":"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"}