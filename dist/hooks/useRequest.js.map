{"version":3,"file":"useRequest.js","names":["_axios","_interopRequireDefault","require","_errorHandler","_succesHandler","_nextIntl","_useUser","_useNetwork","_NotificationManager","_useToast","obj","__esModule","default","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","key","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","defaultOptions","auth","data","requestOptions","headers","notification","pending","success","show","failed","useRequest","initOptions","network","useNetwork","useTranslations","token","clearToken","useUser","pushToastList","dismissToastList","useToast","_options","requestServer","url","method","options","authorization","concat","Promise","resolve","reject","online","Notifications","axios","then","response","successRequest","catch","error","errorResponse","request","errorRequest","errorSetting","_default","exports"],"sources":["../../src/lib/hooks/useRequest.js"],"sourcesContent":["import axios from \"axios\";\r\nimport {errorRequest, errorResponse, errorSetting} from \"../utils/errorHandler\";\r\nimport {successRequest} from \"../utils/succesHandler\";\r\nimport {useTranslations} from \"next-intl\";\r\nimport useUser from \"./useUser\";\r\nimport useNetwork from \"./useNetwork\";\r\nimport Notifications from \"../components/notifications/NotificationManager\";\r\nimport useToast from \"./useToast\";\r\n\r\nconst defaultOptions = {\r\n    auth: false, data: {}, requestOptions: {\r\n        headers: {}\r\n    }, notification: true, pending: true, success: {\r\n        notification: {\r\n            show: true,\r\n        },\r\n    }, failed: {\r\n        notification: {\r\n            show: true,\r\n        },\r\n    },\r\n}\r\nconst useRequest = (initOptions) => {\r\n    const network = useNetwork()\r\n    const t = useTranslations()\r\n    const {token, clearToken} = useUser()\r\n    const {pushToastList, dismissToastList} = useToast();\r\n    let _options = {...defaultOptions, ...initOptions}\r\n\r\n    function requestServer(url = '', method = 'get', options) {\r\n        _options = {..._options, ...options}\r\n        if (_options.auth) _options = {\r\n            ..._options, requestOptions: {\r\n                ..._options.requestOptions,\r\n                headers: {..._options.requestOptions.headers, authorization: `Bearer ${token}`}\r\n            }\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            if (!network.online) {\r\n                reject()\r\n                return\r\n            }\r\n            if (_options.notification && _options.failed.notification.show && _options.pending) {\r\n                dismissToastList([\"pending\", \"warning\", \"error\", \"success\"]);\r\n                Notifications(pushToastList, \"pending\", t);\r\n            }\r\n\r\n            axios({\r\n                url: url, method: method, data: _options.data, ..._options.requestOptions\r\n            })\r\n                .then(response => {\r\n                    successRequest(pushToastList, dismissToastList, response, t, _options)\r\n                    resolve(response)\r\n                })\r\n                .catch(error => {\r\n                    if (error.response) {\r\n                        errorResponse(pushToastList, dismissToastList, error.response, clearToken, t, _options.notification && _options.failed.notification.show)\r\n                    } else if (error.request) {\r\n                        errorRequest(dismissToastList, t, _options.notification && _options.failed.notification.show)\r\n                    } else {\r\n                        errorSetting(dismissToastList, t, _options.notification && _options.failed.notification.show)\r\n                    }\r\n                    reject(error)\r\n                })\r\n        });\r\n    }\r\n\r\n    return requestServer\r\n}\r\n\r\nexport default useRequest"],"mappings":"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"}